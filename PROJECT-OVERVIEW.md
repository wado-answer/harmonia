# ğŸµ Harmonia v3.1 - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**æ›´æ–°æ—¥æ™‚**: 2026å¹´2æœˆ18æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.1.0  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… æœ¬ç•ªç’°å¢ƒå¯¾å¿œæ¸ˆã¿

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ)
4. [ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](#ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥](#ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥)
7. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–)
8. [ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰](#ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰)
9. [æ‹¡å¼µãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚¬ã‚¤ãƒ‰](#æ‹¡å¼µã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚¬ã‚¤ãƒ‰)
10. [GitHubãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±](#githubãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±)

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ä½•ã‹ï¼Ÿ

**Harmonia** ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œã•ã‚Œã‚‹é«˜æ©Ÿèƒ½ãªã‚ªãƒ¼ãƒ«ã‚¤ãƒ³ãƒ¯ãƒ³éŸ³æ¥½å†ç”Ÿã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚IndexedDBã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ã•ã‚Œã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãªã—ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚

### ä¸»ãªç‰¹å¾´

âœ… **å®Œå…¨ãªãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œ** - ã‚µãƒ¼ãƒãƒ¼ãªã—ã§ãƒ–ãƒ©ã‚¦ã‚¶ã ã‘ã§å®Ÿè¡Œ  
âœ… **10ãƒãƒ³ãƒ‰ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼** - é«˜åº¦ãªã‚ªãƒ¼ãƒ‡ã‚£ã‚ªèª¿æ•´  
âœ… **é«˜åº¦ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼** - 7ç¨®é¡ã®å¯è¦–åŒ–ã‚¹ã‚¿ã‚¤ãƒ«  
âœ… **LRCæ­Œè©å¯¾å¿œ** - æ™‚é–“åŒæœŸã•ã‚ŒãŸæ­Œè©è¡¨ç¤º  
âœ… **ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ** - è‡ªå‹•ç”Ÿæˆãƒ»è‡ªå‹•æ›´æ–°  
âœ… **ãƒãƒ«ãƒã‚¨ãƒ•ã‚§ã‚¯ãƒˆ** - ãƒªãƒãƒ¼ãƒ–ã€ãƒ‡ã‚£ãƒ¬ã‚¤ã€ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µãƒ¼ã€ã‚¹ãƒ†ãƒ¬ã‚ªå‡¦ç†  
âœ… **ã‚¯ãƒ©ã‚¦ãƒ‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—** - Google Driveé€£æºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰  
âœ… **PWAå¯¾å¿œ** - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ä½¿ç”¨ãƒ»ãƒ›ãƒ¼ãƒ ç”»é¢ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½  
âœ… **Media Session APIå¯¾å¿œ** - ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®ç‰©ç†ãƒœã‚¿ãƒ³ã§åˆ¶å¾¡å¯èƒ½  

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|---------|------|
| **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰** | Vanilla ES6+ JavaScript, HTML5, CSS3 |
| **ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªAPI** | Web Audio API (AudioContext, GainNode, BiquadFilterNode) |
| **ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹** | Canvas 2D (DPRå¯¾å¿œã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°) |
| **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** | IndexedDB (8ã‚¹ãƒˆã‚¢) |
| **PWA** | Service Worker, manifest.json |
| **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°** | GitHub Pages |
| **ãƒªãƒã‚¸ãƒˆãƒª** | github.com/wado-answer/harmonia |

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹é€ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI Layer (HTML/CSS)                   â”‚
â”‚    UIManager (ui-manager.js) - DOMæ›´æ–°ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PlaylistMgr  â”‚ â”‚  AudioEngineâ”‚ â”‚ VisualizerEngineâ”‚
â”‚   (ç®¡ç†)     â”‚ â”‚  (å†ç”Ÿåˆ¶å¾¡) â”‚ â”‚  (æç”»)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
            â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  StateManager   â”‚    â”‚  ErrorTracker
    â”‚  (çŠ¶æ…‹ç®¡ç†)     â”‚    â”‚  (ãƒ­ã‚®ãƒ³ã‚°)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  DBManager      â”‚
    â”‚  (IndexedDB)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³

**Factory Pattern**: å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯Factoryé–¢æ•°ã§åˆæœŸåŒ–
```javascript
export function createUIManager() { return new UIManager(); }
export function createPlaylistManager() { return new PlaylistManager(); }
```

**Event Bus**: CustomEvent ã«ã‚ˆã‚‹ç–çµåˆãªé€šä¿¡
```javascript
// ç™ºç«å´
document.dispatchEvent(new CustomEvent('harmonia:playTrack', { detail: track }));

// ãƒªã‚¹ãƒŠãƒ¼å´
document.addEventListener('harmonia:playTrack', (e) => { ... });
```

**Observable Pattern**: StateManager ã§ã®çŠ¶æ…‹å¤‰æ›´é€šçŸ¥
```javascript
state.subscribe('currentTrackIndex', (newValue) => {
    console.log('ãƒˆãƒ©ãƒƒã‚¯å¤‰æ›´:', newValue);
});
```

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
harmonia/
â”œâ”€â”€ index.html              # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ app.js                  # HarmoniaApp ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ (2,543è¡Œ)
â”œâ”€â”€ styles.css              # ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
â”‚
â”œâ”€â”€ ui-manager.js           # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç®¡ç†
â”œâ”€â”€ state-manager.js        # çŠ¶æ…‹ï¼ˆObservableï¼‰ç®¡ç†
â”œâ”€â”€ db-manager.js           # IndexedDBæŠ½è±¡åŒ–
â”‚
â”œâ”€â”€ audio-engine.js         # Web Audio APIãƒ©ãƒƒãƒ‘ãƒ¼
â”œâ”€â”€ visualizer-engine.js    # Canvasæç”»ã‚¨ãƒ³ã‚¸ãƒ³
â”‚
â”œâ”€â”€ playlist-manager.js     # ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†
â”œâ”€â”€ smart-playlist.js       # ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç”Ÿæˆ
â”œâ”€â”€ lrc-parser.js           # LRCæ­Œè©ãƒ‘ãƒ¼ã‚µãƒ¼
â”œâ”€â”€ id3-reader.js           # ID3ã‚¿ã‚°èª­ã¿å–ã‚Š
â”‚
â”œâ”€â”€ background-playback.js  # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å†ç”Ÿ
â”œâ”€â”€ cloud-storage.js        # ã‚¯ãƒ©ã‚¦ãƒ‰é€£æº
â”œâ”€â”€ power-profile-manager.js# çœã‚¨ãƒãƒ¢ãƒ¼ãƒ‰ç®¡ç†
â”‚
â”œâ”€â”€ sw.js                   # Service Worker (PWA)
â”œâ”€â”€ manifest.json           # PWAè¨­å®š
â”‚
â”œâ”€â”€ README.md               # ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ GUIDE.md                # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ PROJECT-OVERVIEW.md     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæŠ€è¡“æ¦‚è¦ï¼‰
â””â”€â”€ [ãã®ä»–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]
```

---

## ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 1. **HarmoniaApp** (app.js)

ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã€‚ã™ã¹ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ±åˆã—ã€å†ç”Ÿãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ¶å¾¡ã€‚

```javascript
class HarmoniaApp {
    // åˆæœŸåŒ–
    async init() { ... }
    
    // å†ç”Ÿåˆ¶å¾¡
    async playTrack(index) { ... }
    togglePlay() { ... }
    next() { ... }
    previous() { ... }
    seek(seconds) { ... }
    
    // è¨­å®šç®¡ç†
    async resetEQ() { ... }
    async resetAllEffects() { ... }
    async fullSystemReset() { ... }
    
    // ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    async deleteTrack(trackId) { ... }
    async deleteAllData() { ... }
}
```

**ã‚­ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰** (80+å€‹):
- `init()` - ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ï¼ˆDBæ¥ç¶šã€UIæç”»ã€ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ï¼‰
- `playTrack(index)` - ãƒˆãƒ©ãƒƒã‚¯å†ç”Ÿé–‹å§‹
- `loadData()` - DB ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
- `setupEventListeners()` - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ»ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
- `subscribeToState()` - çŠ¶æ…‹å¤‰æ›´ãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²
- `destroy()` - ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆãƒšãƒ¼ã‚¸é›¢è„±æ™‚ï¼‰

### 2. **UIManager** (ui-manager.js)

DOMæ“ä½œã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€‚

```javascript
class UIManager {
    renderTracks(tracks, currentIndex, favorites) { ... }
    renderQueue(queue, tracks) { ... }
    updatePlayButton(isPlaying) { ... }
    showNotification(message, type) { ... }
    openModal(modalId) { ... }
}
```

### 3. **StateManager** (state-manager.js)

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ä¸€å…ƒç®¡ç†ï¼ˆObservableï¼‰ã€‚

```javascript
class StateManager {
    subscribe(key, callback) { ... }  // å¤‰æ›´ãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²
    setState(updates) { ... }         // çŠ¶æ…‹æ›´æ–°
    get(key) { ... }                 // çŠ¶æ…‹å–å¾—
    getState() { ... }               // å…¨çŠ¶æ…‹å–å¾—
}
```

### 4. **AudioEngine** (audio-engine.js)

Web Audio APIã‚’ä½ãƒ¬ãƒ™ãƒ«ã§åˆ¶å¾¡ã€‚

```javascript
class AudioEngine {
    loadTrack(url) { ... }
    play() { ... }
    pause() { ... }
    seek(time) { ... }
    
    // ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼
    setEQBand(band, gain) { ... }
    
    // ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
    setReverb(enabled, mix, decay) { ... }
    setDelay(enabled, time, feedback, mix) { ... }
    setCompressor(enabled, settings) { ... }
    setStereo(enabled, pan, width) { ... }
}
```

**å†…éƒ¨æ§‹é€ **:
```javascript
this.audioContext = new AudioContext();
this.analyser = audioContext.createAnalyser();
this.gainNode = audioContext.createGain();      // éŸ³é‡
this.eqNodes = [x10];  // 10-band EQ (BiquadFilterNodes)
this.compressor = audioContext.createDynamicsCompressor();
this.convolver = audioContext.createConvolver();
```

### 5. **VisualizerEngine** (visualizer-engine.js)

Canvas 2Dã§é«˜æ€§èƒ½æç”»ã€‚

```javascript
class VisualizerEngine {
    start() { ... }      // requestAnimationFrameãƒ«ãƒ¼ãƒ—é–‹å§‹
    stop() { ... }       // ãƒ«ãƒ¼ãƒ—åœæ­¢
    setStyle(style) { ...}  // 'bars', 'waveform', ãªã©7ç¨®é¡
    setColors(primary, secondary, accent) { ... }
    setQuality(quality) { ... }  // 'high', 'medium', 'low'
}
```

**ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«** (7ç¨®é¡):
- `bars` - å‘¨æ³¢æ•°ãƒãƒ¼
- `waveform` - æ³¢å½¢è¡¨ç¤º
- `circle` - å††å½¢ã‚¹ãƒšã‚¯ãƒˆãƒ©ãƒ 
- `spectrum` - ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
- `radial` - ãƒ©ã‚¸ã‚¢ãƒ«æ³¢å½¢
- `dot` - ãƒ‰ãƒƒãƒˆè¡¨ç¾
- `liquid` - æ¶²ä½“è¡¨ç¾

### 6. **DBManager** (db-manager.js)

IndexedDB ã®æŠ½è±¡åŒ–ã€‚

```javascript
class DBManager {
    async save(storeName, object) { ... }
    async get(storeName, key) { ... }
    async getAll(storeName) { ... }
    async delete(storeName, key) { ... }
    async clear(storeName) { ... }
    async clearAll() { ... }
}
```

**ã‚¹ãƒˆã‚¢** (8å€‹):
| ã‚¹ãƒˆã‚¢ | ç”¨é€” |
|--------|------|
| `audioFiles` | ãƒˆãƒ©ãƒƒã‚¯ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿ |
| `playlists` | é€šå¸¸ + ã‚¹ãƒãƒ¼ãƒˆ |
| `favorites` | ãŠæ°—ã«å…¥ã‚Šãƒˆãƒ©ãƒƒã‚¯ID |
| `queue` | å†ç”Ÿã‚­ãƒ¥ãƒ¼ |
| `settings` | ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š |
| `lyrics` | LRC + ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ |
| `bookmarks` | æ™‚é–“ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ |
| `playHistory` | å†ç”Ÿå±¥æ­´ |

### 7. **ErrorTracker** (app.jså†…)

äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ã‚’ä¸€å…ƒç®¡ç†ã—ã€ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ã«å‡¦ç†ã€‚

```javascript
class ErrorTracker {
    track(error, context) { ... }
    getUserMessage(error) { ... }  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    getStatistics() { ... }
    downloadLogs() { ... }
}
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### ãƒˆãƒ©ãƒƒã‚¯å†ç”Ÿã®æµã‚Œ

```
â‘  ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒˆãƒ©ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯
     â†“
â‘¡ UIManager â†’ document.dispatchEvent('harmonia:playTrack', { detail: track })
     â†“
â‘¢ HarmoniaApp.playTrack(index) ãƒªãƒƒã‚¹ãƒ³
     â†“
â‘£ AudioEngine.loadTrack(track.url) - éåŒæœŸèª­ã¿è¾¼ã¿
     â†“
â‘¤ AudioEngine.play() - å†ç”Ÿé–‹å§‹
     â†“
â‘¥ StateManager.setState({ currentTrackIndex: index, isPlaying: true })
     â†“
â‘¦ SubscribeHandler triggered â†’ UIæ›´æ–°
     â”œâ”€ UIManager.updateNowPlaying(track)
     â”œâ”€ UIManager.updatePlayButton(true)
     â””â”€ VisualizerEngine.start() - æç”»é–‹å§‹
     â†“
â‘§ MediaSession APIæ›´æ–° - ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãƒ­ãƒƒã‚¯ç”»é¢ã«æƒ…å ±è¡¨ç¤º
     â†“
â‘¨ å†ç”Ÿå±¥æ­´è¨˜éŒ² - recordPlayHistory(trackId)
     â†“
â‘© LRCæ­Œè©è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« - startLyricsAutoScroll()
```

### è¨­å®šå¤‰æ›´ã®ãƒ•ãƒ­ãƒ¼

```
â‘  UIManager - settings ãƒ•ã‚©ãƒ¼ãƒ ã§å€¤ã‚’å¤‰æ›´
     â†“
â‘¡ document.dispatchEvent('harmonia:updateMultipleSettings', { detail: updates })
     â†“
â‘¢ HarmoniaApp.updateMultipleSettings(updates) ãƒªãƒƒã‚¹ãƒ³
     â†“
â‘£ StateManager.updateSettings(updates)
     â†“
â‘¤ è¨­å®šå¤‰æ›´ã‚’ subscriber ã«é€šçŸ¥
     â””â”€ subscribeToState() ã‚·ã‚¹ã‚¿ãƒ¼ "settings" ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ
     â†“
â‘¥ applySettingChange(key, value) - å„è¨­å®šã‚’å®Ÿéš›ã«åæ˜ 
     â”œâ”€ EQè¨­å®š â†’ AudioEngine.setEQBand() å‘¼ã³å‡ºã—
     â”œâ”€ ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼è¨­å®š â†’ VisualizerEngine.setQuality()
     â”œâ”€ ãƒ†ãƒ¼ãƒè‰² â†’ ğŸ¨ CSSå¤‰æ•° --theme-accent æ›´æ–°
     â””â”€ ãã®ä»– â†’ å¯¾å¿œã™ã‚‹å‡¦ç†
     â†“
â‘¦ await saveSettings() - IndexedDB ã«æ°¸ç¶šåŒ–
     â†“
â‘§ å®Œäº† + UIé€šçŸ¥
```

---

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

### ãƒ¬ãƒ™ãƒ«1: ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼

```javascript
// äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒ
window.addEventListener('error', (event) => {
    errorTracker.track(event.error, { source: 'uncaught-exception' });
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
});

// æœªå‡¦ç†ã®Promiseæ‹’å¦
window.addEventListener('unhandledrejection', (event) => {
    errorTracker.track(event.reason, { source: 'unhandled-promise-rejection' });
});
```

### ãƒ¬ãƒ™ãƒ«2: try-catch ãƒ©ãƒƒãƒ”ãƒ³ã‚°

é‡è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã« try-catch ã‚’å®Ÿè£…ï¼š
- `init()` - åˆæœŸåŒ–
- `loadData()` - ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
- `playTrack()` - å†ç”Ÿ
- `saveSettings()` - è¨­å®šä¿å­˜
- `handleFileUpload()` - ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†

### ãƒ¬ãƒ™ãƒ«3: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒƒãƒ”ãƒ³ã‚°

```javascript
const errorMap = {
    'NotAllowedError': 'ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã«ã‚ˆã‚Šæ“ä½œãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    'QuotaExceededError': 'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ãŒæº€æ¯ã§ã™',
    'NetworkError': 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚¨ãƒ©ãƒ¼ã§ã™',
    // ...
};
```

### ãƒ¬ãƒ™ãƒ«4: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ä¿å­˜

```javascript
errorTracker.errors  // æœ€å¤§50å€‹ã®ã‚¨ãƒ©ãƒ¼è¨˜éŒ²
errorTracker.downloadLogs()  // JSONã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½
window.harmonia.errorTracker.getStatistics()  // ã‚¨ãƒ©ãƒ¼çµ±è¨ˆç¢ºèª
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

| æœ€é©åŒ– | è©³ç´° | åŠ¹æœ |
|--------|------|------|
| **ãƒãƒƒãƒå‡¦ç†** | ãƒˆãƒ©ãƒƒã‚¯èª­ã¿è¾¼ã¿ã‚’100å€‹å˜ä½ã§å‡¦ç† | ãƒ¡ãƒ¢ãƒªã‚¹ãƒ‘ã‚¤ã‚¯é˜²æ­¢ |
| **Debouncing** | å†ç”Ÿé€²æ—æ›´æ–°ã‚’250msé–“éš”ã«åˆ¶é™ | CPUä½¿ç”¨æ™‚é–“â†“15% |
| **DPRå¯¾å¿œ** | Canvas ã®DPRï¼ˆãƒ‡ãƒã‚¤ã‚¹ãƒ”ã‚¯ã‚»ãƒ«æ¯”ï¼‰ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚° | Retinaå¯¾å¿œ |
| **Blob URLç®¡ç†** | URL.revokeObjectURL ã§æ˜ç¤ºçš„ã«è§£æ”¾ | ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢ |
| **é…å»¶åˆæœŸåŒ–** | ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ã‚’åˆå›ä½¿ç”¨æ™‚ã«åˆæœŸåŒ– | èµ·å‹•æ™‚é–“â†“30% |
| **æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•** | DBæ¥ç¶šå¤±æ•—æ™‚ã«2sâ†’4sâ†’8så¾…æ©Ÿ | ã‚µãƒ¼ãƒãƒ¼éè² è·å¯¾ç­– |
| **EventListenerè¿½è·¡** | ç™»éŒ²ãƒ»å‰Šé™¤ã‚’é…åˆ—ã§è¿½è·¡ | ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢ |
| **ResizeObserver** | Canvas ãƒªã‚µã‚¤ã‚ºæ¤œå‡º | è‡ªå‹•DPIèª¿æ•´ |
| **requestAnimationFrame** | æç”»ã‚’60fpsã«åŒæœŸ | CPUåŠ¹ç‡åŒ– |
| **gaplessPlayback** | æ¬¡ãƒˆãƒ©ãƒƒã‚¯äº‹å‰èª­ã¿è¾¼ã¿ | ç„¡éŸ³æ™‚é–“æ’é™¤ |

---

## ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰

ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆF12ã‚­ãƒ¼ï¼‰ã§ä»¥ä¸‹ãŒå®Ÿè¡Œå¯èƒ½ï¼š

### å†ç”Ÿåˆ¶å¾¡

```javascript
// å†ç”Ÿ
window.harmonia.togglePlay();

// æ¬¡ã¸
window.harmonia.next();

// å‰ã¸
window.harmonia.previous();

// ãƒˆãƒ©ãƒƒã‚¯æŒ‡å®šå†ç”Ÿ
window.harmonia.playTrack(0);  // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ã®ãƒˆãƒ©ãƒƒã‚¯

// ã‚·ãƒ¼ã‚¯ã—ã¦(ç§’å˜ä½)
window.harmonia.seek(30);  // +30ç§’

// éŸ³é‡è¨­å®š (0.0 - 1.0)
window.harmonia.setVolume(0.8);
```

### è¨­å®šãƒ»ãƒªã‚»ãƒƒãƒˆ

```javascript
// EQãƒªã‚»ãƒƒãƒˆ
window.harmonia.resetEQ();

// ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ãƒªã‚»ãƒƒãƒˆ
window.harmonia.resetVisualizerSettings();

// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒªã‚»ãƒƒãƒˆ
window.harmonia.resetAllEffects();

// å®Œå…¨ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚»ãƒƒãƒˆ
await window.harmonia.fullSystemReset();

// è¨­å®šãƒªã‚»ãƒƒãƒˆ
await window.harmonia.resetSettings();
```

### ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ

```javascript
// æœ€é »å†ç”Ÿãƒˆãƒ©ãƒƒã‚¯
window.harmonia.secretPlay();

// çµ±è¨ˆæƒ…å ±è¡¨ç¤º
window.harmonia.secretStats();

// ãƒ©ãƒ³ãƒ€ãƒ ãƒ†ãƒ¼ãƒ
window.harmonia.secretTheme();
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```javascript
// ã‚¨ãƒ©ãƒ¼çµ±è¨ˆç¢ºèª
console.log(window.harmonia.errorTracker.getStatistics());

// ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
window.harmonia.errorTracker.downloadLogs();

// ã‚¨ãƒ©ãƒ¼å±¥æ­´ç¢ºèª
console.log(window.harmonia.errorTracker.errors);
```

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```javascript
// ãƒ‡ãƒ¼ã‚¿å…¨å‰Šé™¤
await window.harmonia.deleteAllData();

// å†ç”Ÿå±¥æ­´ã‚¯ãƒªã‚¢
await window.harmonia.clearPlayHistory();

// ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
window.harmonia.exportPlaylists();

// ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
await window.harmonia.exportFullBackup();
```

---

## æ‹¡å¼µãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚¬ã‚¤ãƒ‰

### æ–°ã—ã„ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ 

[visualizer-engine.js](visualizer-engine.js#L200) ã«ã¦ï¼š

```javascript
// drawers ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ 
drawers: {
    myStyle: (ctx, frequencyData, canvas, color1, color2) => {
        // ã‚«ã‚¹ã‚¿ãƒ æç”»ãƒ­ã‚¸ãƒƒã‚¯
        ctx.fillStyle = color1;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        // ...
    }
}

// stylesé…åˆ—ã«è¿½åŠ 
styles: [ ..., 'myStyle' ]
```

### æ–°ã—ã„ã‚¤ã‚³ãƒ©ã‚¤ã‚¶ãƒ¼ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’è¿½åŠ 

[audio-engine.js](audio-engine.js#L350) ã«ã¦ï¼š

```javascript
eqPresets: {
    myCustom: [
        2, 3, 1, 0, -1, -2, -1, 0, 2, 3
    ]
}
```

### æ–°ã—ã„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å®Ÿè£…

```javascript
// AudioEngine.js ã«æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
setNewEffect(enabled, params) {
    if (enabled) {
        const effect = this.audioContext.createXXX();
        // è¨­å®š...
        this.gainNode.connect(effect);
    }
}

// app.js ã«å¯¾å¿œã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
document.addEventListener('harmonia:setNewEffect', (e) => {
    this.setNewEffect(e.detail.enabled, e.detail.params);
});
```

### ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚¤ãƒ—ã‚’è¿½åŠ 

[smart-playlist.js](smart-playlist.js#L100) ã«ã¦ï¼š

```javascript
case 'myType':
    return smartPlaylistEngine.myCustomFilter(tracks, params);

// ãƒ•ã‚£ãƒ«ã‚¿ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
myCustomFilter(tracks, params) {
    return tracks.filter(t => {
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ­ã‚¸ãƒƒã‚¯
        return t.duration > params.minDuration;
    });
}
```

---

## GitHubãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±

### ãƒªãƒã‚¸ãƒˆãƒª

**URL**: https://github.com/wado-answer/harmonia  
**ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: GitHub Pages  
**ãƒ‡ãƒ¢**: https://wado-answer.github.io/harmonia/

### ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

| ãƒ–ãƒ©ãƒ³ãƒ | ç”¨é€” |
|---------|------|
| `main` | æœ¬ç•ªç’°å¢ƒï¼ˆGitHub Pagesï¼‰âœ… |
| `develop` | é–‹ç™ºç‰ˆ |
| `feature/*` | æ©Ÿèƒ½é–‹ç™º |

### ãƒ‡ãƒ—ãƒ­ã‚¤

`main` ãƒ–ãƒ©ãƒ³ãƒã¸ã®push â†’ è‡ªå‹•çš„ã«GitHub Pagesã«å…¬é–‹

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèªï¼ˆä»»æ„ï¼‰
python -m http.server 8000

# ãƒ–ãƒ©ã‚¦ã‚¶
http://localhost:8000
```

### ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†

âœ… **Gitç®¡ç†å¯¾è±¡**:
- `*.js`, `*.html`, `*.css`
- `*.md` (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)
- `manifest.json`, `sw.js` (PWA)

âŒ **Gitç„¡è¦–å¯¾è±¡** (.gitignore):
- `node_modules/`
- `dist/`, `build/`
- `.DS_Store`, `desktop.ini`
- IDEè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

---

## ã¾ã¨ã‚

| é …ç›® | è©³ç´° |
|------|------|
| **è¨€èª** | JavaScript (ES6+) |
| **ãƒ•ã‚¡ã‚¤ãƒ«æ•°** | 15+ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| **ã‚³ãƒ¼ãƒ‰è¡Œæ•°** | ~8000è¡Œ |
| **ãƒ†ã‚¹ãƒˆå¯¾å¿œ** | Chrome, Firefox, Safari, Edge |
| **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ** | âœ… Service Worker + IndexedDB |
| **ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ** | âœ… PWA + ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– |
| **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£** | âœ… media controlså¯¾å¿œ |
| **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹** | MIT |
| **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹** | ãŠæ°—è»½ã« Issue/PR ã©ã†ã |

---

**è³ªå•ãƒ»æ”¹å–„ææ¡ˆ**: GitHub Issues  
**ã‚³ãƒ¼ãƒ‰è²¢çŒ®**: GitHub Pull Requests  
**ãƒ©ã‚¤ãƒ–ãƒ‡ãƒ¢**: https://wado-answer.github.io/harmonia/

